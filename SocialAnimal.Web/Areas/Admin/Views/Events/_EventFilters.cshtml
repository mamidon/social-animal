@model EventListFilters

<form id="filter-form" 
      hx-get="/admin/events/list-partial"
      hx-target="#event-list"
      hx-trigger="change">
    
    <div class="filter-group">
        <label>Search</label>
        <input type="text" 
               name="search" 
               value="@Model.Search"
               placeholder="Event title or location..."
               hx-get="/admin/events/list-partial"
               hx-trigger="keyup changed delay:500ms"
               hx-target="#event-list"
               hx-include="#filter-form">
    </div>
    
    <div class="filter-group">
        <label>State</label>
        <select name="state" 
                id="state-filter"
                hx-get="/admin/events/cities"
                hx-trigger="change"
                hx-target="#city-filter">
            <option value="">All States</option>
            <option value="AL" selected="@(Model.State == "AL" ? "true" : "false")">Alabama</option>
            <option value="AK" selected="@(Model.State == "AK" ? "true" : "false")">Alaska</option>
            <option value="AZ" selected="@(Model.State == "AZ" ? "true" : "false")">Arizona</option>
            <option value="AR" selected="@(Model.State == "AR" ? "true" : "false")">Arkansas</option>
            <option value="CA" selected="@(Model.State == "CA" ? "true" : "false")">California</option>
            <option value="CO" selected="@(Model.State == "CO" ? "true" : "false")">Colorado</option>
            <option value="CT" selected="@(Model.State == "CT" ? "true" : "false")">Connecticut</option>
            <option value="DE" selected="@(Model.State == "DE" ? "true" : "false")">Delaware</option>
            <option value="FL" selected="@(Model.State == "FL" ? "true" : "false")">Florida</option>
            <option value="GA" selected="@(Model.State == "GA" ? "true" : "false")">Georgia</option>
            <option value="HI" selected="@(Model.State == "HI" ? "true" : "false")">Hawaii</option>
            <option value="ID" selected="@(Model.State == "ID" ? "true" : "false")">Idaho</option>
            <option value="IL" selected="@(Model.State == "IL" ? "true" : "false")">Illinois</option>
            <option value="IN" selected="@(Model.State == "IN" ? "true" : "false")">Indiana</option>
            <option value="IA" selected="@(Model.State == "IA" ? "true" : "false")">Iowa</option>
            <option value="KS" selected="@(Model.State == "KS" ? "true" : "false")">Kansas</option>
            <option value="KY" selected="@(Model.State == "KY" ? "true" : "false")">Kentucky</option>
            <option value="LA" selected="@(Model.State == "LA" ? "true" : "false")">Louisiana</option>
            <option value="ME" selected="@(Model.State == "ME" ? "true" : "false")">Maine</option>
            <option value="MD" selected="@(Model.State == "MD" ? "true" : "false")">Maryland</option>
            <option value="MA" selected="@(Model.State == "MA" ? "true" : "false")">Massachusetts</option>
            <option value="MI" selected="@(Model.State == "MI" ? "true" : "false")">Michigan</option>
            <option value="MN" selected="@(Model.State == "MN" ? "true" : "false")">Minnesota</option>
            <option value="MS" selected="@(Model.State == "MS" ? "true" : "false")">Mississippi</option>
            <option value="MO" selected="@(Model.State == "MO" ? "true" : "false")">Missouri</option>
            <option value="MT" selected="@(Model.State == "MT" ? "true" : "false")">Montana</option>
            <option value="NE" selected="@(Model.State == "NE" ? "true" : "false")">Nebraska</option>
            <option value="NV" selected="@(Model.State == "NV" ? "true" : "false")">Nevada</option>
            <option value="NH" selected="@(Model.State == "NH" ? "true" : "false")">New Hampshire</option>
            <option value="NJ" selected="@(Model.State == "NJ" ? "true" : "false")">New Jersey</option>
            <option value="NM" selected="@(Model.State == "NM" ? "true" : "false")">New Mexico</option>
            <option value="NY" selected="@(Model.State == "NY" ? "true" : "false")">New York</option>
            <option value="NC" selected="@(Model.State == "NC" ? "true" : "false")">North Carolina</option>
            <option value="ND" selected="@(Model.State == "ND" ? "true" : "false")">North Dakota</option>
            <option value="OH" selected="@(Model.State == "OH" ? "true" : "false")">Ohio</option>
            <option value="OK" selected="@(Model.State == "OK" ? "true" : "false")">Oklahoma</option>
            <option value="OR" selected="@(Model.State == "OR" ? "true" : "false")">Oregon</option>
            <option value="PA" selected="@(Model.State == "PA" ? "true" : "false")">Pennsylvania</option>
            <option value="RI" selected="@(Model.State == "RI" ? "true" : "false")">Rhode Island</option>
            <option value="SC" selected="@(Model.State == "SC" ? "true" : "false")">South Carolina</option>
            <option value="SD" selected="@(Model.State == "SD" ? "true" : "false")">South Dakota</option>
            <option value="TN" selected="@(Model.State == "TN" ? "true" : "false")">Tennessee</option>
            <option value="TX" selected="@(Model.State == "TX" ? "true" : "false")">Texas</option>
            <option value="UT" selected="@(Model.State == "UT" ? "true" : "false")">Utah</option>
            <option value="VT" selected="@(Model.State == "VT" ? "true" : "false")">Vermont</option>
            <option value="VA" selected="@(Model.State == "VA" ? "true" : "false")">Virginia</option>
            <option value="WA" selected="@(Model.State == "WA" ? "true" : "false")">Washington</option>
            <option value="WV" selected="@(Model.State == "WV" ? "true" : "false")">West Virginia</option>
            <option value="WI" selected="@(Model.State == "WI" ? "true" : "false")">Wisconsin</option>
            <option value="WY" selected="@(Model.State == "WY" ? "true" : "false")">Wyoming</option>
        </select>
    </div>
    
    <div class="filter-group">
        <label>City</label>
        <select name="city" id="city-filter">
            <option value="">All Cities</option>
            @if(!string.IsNullOrEmpty(Model.City))
            {
                <option value="@Model.City" selected>@Model.City</option>
            }
        </select>
    </div>
    
    <div class="filter-group">
        <label>
            <input type="checkbox" 
                   name="includeDeleted" 
                   value="true"
                   @(Model.IncludeDeleted ? "checked" : "")>
            Include Deleted
        </label>
    </div>
    
    <button type="button" 
            onclick="clearFilters()"
            class="btn btn-link">
        Clear Filters
    </button>
</form>

<script>
function clearFilters() {
    document.getElementById('filter-form').reset();
    document.getElementById('city-filter').innerHTML = '<option value="">All Cities</option>';
    htmx.trigger('#filter-form', 'submit');
}

// Update cities when state changes
document.getElementById('state-filter').addEventListener('change', function() {
    const state = this.value;
    const citySelect = document.getElementById('city-filter');
    
    if (state) {
        fetch(`/admin/events/cities?state=${state}`)
            .then(response => response.json())
            .then(cities => {
                citySelect.innerHTML = '<option value="">All Cities</option>';
                cities.forEach(city => {
                    const option = document.createElement('option');
                    option.value = city.value;
                    option.textContent = city.text;
                    citySelect.appendChild(option);
                });
            })
            .catch(error => {
                console.error('Error fetching cities:', error);
                citySelect.innerHTML = '<option value="">All Cities</option>';
            });
    } else {
        citySelect.innerHTML = '<option value="">All Cities</option>';
    }
});
</script>